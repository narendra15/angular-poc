export function formatUserAppsObj(codes: any[]): UserAppsRolesObj {
  const userApps: UserAppsMap = {};

  codes.forEach((code) => {
    // Expect: "APPNAME | ROLE | URL" but ignore URL here
    const parts = String(code).split('|').map(p => p.trim());
    if (parts.length < 2) return;

    const [appRaw, roleRaw] = parts;
    if (!appRaw || !roleRaw) return;

    const app = appRaw.toLowerCase();
    const role = roleRaw.toUpperCase();

    if (!userApps[app]) {
      userApps[app] = { roles: [] };
    }

    if (!userApps[app].roles.includes(role)) {
      userApps[app].roles.push(role);
    }
  });

  return { user_apps: userApps };
}




export function buildAppRoleCodes(codes: string[]): string[] {
  const result: string[] = [];

  codes.forEach(code => {
    // Expect format: "APPNAME | ROLE | URL"
    const parts = String(code).split('|').map(p => p.trim());
    if (parts.length < 3) return; // guard against bad values

    const [appRaw, roleRaw] = parts;
    if (!appRaw || !roleRaw) return;

    // Replace '-' with '_' in app name, preserve rest
    const app = appRaw.replace(/-/g, '_');
    const role = roleRaw.toUpperCase();

    result.push(`${app}-${role}`);
  });

  return result;
}
