applySearchBoxFilters() {
  const searchTerm = this.searchInput?.toLowerCase() || '';

  this.fileGridFilteredData = this.fileOriginalData.filter((row: any) => {
    const metadataKeysWithChanges: Set<string> = new Set();
    let metadataMatch = false;

    // SAFELY check metadata only if status is 'M'
    if (row.status === 'M') {
      const metadata = row.metadata;
      if (Array.isArray(metadata)) {
        metadataMatch = metadata.some((metaItem: any) => {
          return Object.entries(metaItem).some(([key, entry]: [string, any]) => {
            if (entry?.new_value) {
              metadataKeysWithChanges.add(key);
              if (
                typeof entry.new_value === 'string' &&
                entry.new_value.toLowerCase().includes(searchTerm)
              ) {
                return true; // Match found
              }
            }
            return false;
          });
        });
      } else {
        console.warn('metadata is not an array for row:', row);
      }
    }

    // Search top-level only for keys not present in metadata
    const topLevelMatch = Object.entries(row).some(([key, value]: [string, any]) => {
      return (
        !metadataKeysWithChanges.has(key) &&
        typeof value === 'string' &&
        value.toLowerCase().includes(searchTerm)
      );
    });

    return topLevelMatch || metadataMatch;
  });
}
